<script>
    var modules={};
    var index = 0;
    var log = function(msg){
        console.log(msg);
        if(++index>100){
            console.log(modules);
            throw "call times is too more"
        }
    };
    var require = (mid) => {
        if(!modules[mid]){
            modules[mid] = window[mid]();
        }
        return modules[mid];
    };

    var A = () => {
        log("call A");
        var b = require("B");
        return "A:"+b;
    };

    var B = () => {
        log("call B");
        var a = require("A");
        return "B:"+a;
    };

    require("A");
    log(modules);
    alert(888)
</script>